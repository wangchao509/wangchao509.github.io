(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{355:function(o,r,A){o.exports=A.p+"assets/img/big_data.61ed42a5.png"},356:function(o,r,A){o.exports=A.p+"assets/img/data_page.78ec5d7a.png"},357:function(o,r,A){o.exports=A.p+"assets/img/data_page2.b7433bc4.png"},358:function(o,r,A){o.exports=A.p+"assets/img/table_space.8583f528.png"},359:function(o,r,A){o.exports=A.p+"assets/img/linux_file_system.7dfeb846.png"},360:function(o,r,A){o.exports=A.p+"assets/img/mysql_linux.eb6cdaaa.png"},361:function(o,r,A){o.exports=A.p+"assets/img/linux_RAID.8eb97e5b.png"},362:function(o,r,A){o.exports=A.p+"assets/img/linux_raid2.ded68e4b.png"},363:function(o,r,A){o.exports=A.p+"assets/img/Raid_SDRAM.44870179.png"},364:function(o,r,A){o.exports=A.p+"assets/img/Raid_SDRAM2.d75635d7.png"},365:function(o,r,A){o.exports=A.p+"assets/img/Raid_SDRAM.png3.dae573fe.png"},366:function(o,r,A){o.exports=A.p+"assets/img/mysql_connection.a1883a28.png"},367:function(o,r){o.exports="data:image/png;base64,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"},368:function(o,r,A){o.exports=A.p+"assets/img/max_connection_reason.c38859d8.png"},369:function(o,r,A){o.exports=A.p+"assets/img/buffer_pool_load_data.60854021.png"},370:function(o,r,A){o.exports=A.p+"assets/img/redo-log-block.8b4f5554.png"},371:function(o,r,A){o.exports=A.p+"assets/img/redo-log-block-header.cbdadb33.png"},372:function(o,r,A){o.exports=A.p+"assets/img/redo_log_block_file.3145e443.png"},373:function(o,r,A){o.exports=A.p+"assets/img/redo_log_block_modify.4cccb9bd.png"},374:function(o,r,A){o.exports=A.p+"assets/img/redo_log_buffer.d5a0ab43.png"},375:function(o,r,A){o.exports=A.p+"assets/img/redo_log_buffer_file.5a90fb5b.png"},376:function(o,r,A){o.exports=A.p+"assets/img/redo_log_block_many_log.ddf5c1e5.png"},377:function(o,r,A){o.exports=A.p+"assets/img/redo_log_block_little_log.c2c8d814.png"},378:function(o,r,A){o.exports=A.p+"assets/img/os_cache.ab88ec0b.png"},379:function(o,r,A){o.exports=A.p+"assets/img/undo_log.e96af5aa.png"},380:function(o,r,A){o.exports=A.p+"assets/img/undo_log_structure.6195a0dd.png"},389:function(o,r,A){"use strict";A.r(r);var t=A(42),v=Object(t.a)({},(function(){var o=this,r=o.$createElement,t=o._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":o.$parent.slotKey}},[t("h1",{attrs:{id:"mysql章节"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql章节"}},[o._v("#")]),o._v(" mysql章节")]),o._v(" "),t("h2",{attrs:{id:"mysql物理数据存储格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql物理数据存储格式"}},[o._v("#")]),o._v(" MySQL物理数据存储格式")]),o._v(" "),t("p",[t("strong",[o._v("一行数据在磁盘上是如何存储的？")]),t("br"),o._v("\n这里涉及到一个概念，行格式。我们可以对一个表指定它的行存储格式是什么样的，比如COMPACT")]),o._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[o._v("CREATE TABLE table_name(columns) ROW_FORMAT=COMPACT  \nALTER TABLE  table_name ROW_FORMAT=COMPACT  \n")])])]),t("p",[o._v("你可以在建表的时候就指定行存储的格式，也可以建表后修改行存储的格式")]),o._v(" "),t("hr"),o._v(" "),t("p",[t("strong",[o._v("每一行数据实际存储的时候，格式类似这样：")])]),o._v(" "),t("blockquote",[t("p",[t("em",[o._v("变长字段的长度列表，null值列表，数据头，column01的值，column02的值，column0n的值....")]),t("br"),o._v(" "),t("strong",[o._v("行格式:")]),o._v(" 对于每行数据，他其实存储的时候都会有一些头字段对这行数据进行一定的描述，然后再放上这行数据每一列的具体的值。除了COMPACT意外，还有其他几种行存储格式，大同小异。")])]),o._v(" "),t("h2",{attrs:{id:"变长字段在磁盘是怎么存储的"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#变长字段在磁盘是怎么存储的"}},[o._v("#")]),o._v(" 变长字段在磁盘是怎么存储的")]),o._v(" "),t("p",[o._v("假设现在有一行数据，它有三个字段，分别是varchar(10),char(1),char(1),所以这行数据可能是hello a a，第一个字段的值是hello，第二和第三个字段都是a"),t("br"),o._v("\n第二行数据，假设这行数据是hi a a，第一个字段是hi，后面两个字段是a"),t("br"),o._v("\n假设把上面两行数据写入了一个磁盘文件里，两行数据是挨在一起的，那么这两行数据在磁盘里可能是hello a a hi a a"),t("br"),o._v(" "),t("strong",[o._v("为什么变长字段难以读取")]),t("br"),o._v("\n因为我们不知道变长字段的实际长度，所以需要引入"),t("strong",[o._v("变长字段的长度列表")]),t("br"),o._v("\n比如你在存储hello a a的时候，需要带上一些额外的附加信息，第一块就是变长字段的长度列表"),t("br"),o._v("\nhello字段长度是5，十六进制是0x05，在磁盘中存储格式是这样的：0x05 null值列表 数据头 hello a a"),t("br"),o._v("\nhi字段长度是2，十六进制是0x02，在磁盘中存储格式是这样的：0x02 null值列表 数据头 hi a a"),t("br"),o._v(" "),t("strong",[o._v("然后两行数据放在磁盘文件中格式如下：")]),t("br"),o._v("\n0x05 null值列表 数据头 hello a a 0x02 null值列表 数据头 hi a a")]),o._v(" "),t("h3",{attrs:{id:"多个变长字段-如何存储他们的长度"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#多个变长字段-如何存储他们的长度"}},[o._v("#")]),o._v(" 多个变长字段，如何存储他们的长度")]),o._v(" "),t("p",[o._v("比如一行数据有五个字段，分别是varchar(10),varchar(5),varchar(20),char(1),char(1)"),t("br"),o._v("\n这行数据是:"),t("strong",[o._v("hello hi hao a a")]),t("br"),o._v("\n现在hello hi hao三个字段的长度分别是0x05,0x02,0x03，但是在"),t("strong",[o._v("实际存放变长字段长度列表的时候，是逆序放的")]),o._v("，所以这行数据可能按下面的方式存放："),t("br"),o._v(" "),t("em",[t("strong",[o._v("0x03 0x02 0x05 null值列表 数据头 hello hi hao a a")])])]),o._v(" "),t("h2",{attrs:{id:"null值是怎么存储的"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#null值是怎么存储的"}},[o._v("#")]),o._v(" NULL值是怎么存储的？")]),o._v(" "),t("p",[o._v("如果一个字段是null，说明该字段什么都没有。如果存入null字符串的话太浪费空间了，解决方案如下："),t("br"),o._v(" "),t("strong",[o._v("NULL值以二进制bit位来存储")]),t("br"),o._v("\n接下来看看NULL值列表在磁盘上到底如何存储？"),t("br"),o._v("\n很简单，对于所有的NULL值，不通过字符串在磁盘上存储，而是通过二进制的bit位来存储，一行数据里假设多个字段都是NULL，那么这些字段的NULL是以bit位的形式存到了NULL值列表中。"),t("br"),o._v("\n举个例子，假设有一张表，建表语句如下：")]),o._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[o._v("CREATE TABLE customer(\n  name VARCHAR(10) NOT NULL,\n  address VARCHAR(20),\n  gender CHAR(1),\n  job  VARCHAR(30),\n  school VARCHAR(50)\n)\n")])])]),t("p",[o._v("客户表有五个字段，分别代表姓名、地址、性别、工作和学校。4个变长字段，1个定长字段，其中name是不能为NULL的。"),t("br"),o._v("\n现在我们假设有如下一行数据，“jack NULL m NULL xx_school”,其中5个字段2个是NULL"),t("br"),o._v("\n针对上面假设的数据，我们有4个变长字段，按照前面说的，变长字段长度列表，我们是不是应该逆序存放name，address、job、school的长度？"),t("br"),o._v("\n说起来是这样，但是我们要注意一个问题，变长字段的值可能是NULL，如果变长字段值为NULL，那么是不需要在变长字段长度列表中存放其长度的。如下所示："),t("br"),o._v(" "),t("em",[o._v("0x09 0x04 NULL值列表 头信息 column1=value1 column2=value2 ... columnN=valueN")]),t("br"),o._v(" "),t("strong",[o._v("NULL值列表存放的是所有允许为NULL的字段（不是说字段值为NULL，而是允许为NULL）")]),t("br"),o._v("\n在NULL值列表中，存放的是二进制bit位，比如bit值是1，说明是NULL，如果bit值是0，说明不是NULL。"),t("br"),o._v("\n比如上面四个字段（address，gender，job，school）都允许为null，“jack NULL m NULL xx_school”中两个字段是NULL，2个字段不是null，所以4个bit位应该是1010，但是"),t("strong",[o._v("实际存放NULL值列表的时候，是按照逆序存放的")]),o._v("，放入的是0101。所以数据看着像下面所示："),t("br"),o._v(" "),t("em",[o._v("0x09 0x04 0101 头信息 column1=value1 column2=value2 ... columnN=valueN")]),t("br"),o._v(" "),t("strong",[o._v("另外，NULL值列表存放的时候不仅仅是4个bit位，至少要是8个bit位的倍数，如果不足8个bit位，需要在前面补0（高位补零），实际存放如下所示：")]),t("br"),o._v(" "),t("em",[o._v("0x09 0x04 00000101 头信息 column1=value1 column2=value2 ... columnN=valueN")])]),o._v(" "),t("h2",{attrs:{id:"_40个bit位的数据头"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_40个bit位的数据头"}},[o._v("#")]),o._v(" 40个bit位的数据头")]),o._v(" "),t("p",[o._v("前两个bit位都是预留的，没有任何含义")]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("接下来一个bit位是"),t("strong",[o._v("delete_mask")]),o._v(",标识这行数据是否被删除了。所以说mysql删除一条数据的时候，未必是立马把它从磁盘清理掉")]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("下一个bit为是"),t("strong",[o._v("min_rec_mask")]),o._v(",B+树里每一层的非叶子节点里的最小值都有这个标记")]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("接下来4个bit位是"),t("strong",[o._v("n_owned")]),o._v(",它记录了一个记录数，具体作用后续会讲")]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("接着有13个bit位是"),t("strong",[o._v("heap_no")]),o._v(",它代表当前这行数据在记录堆里的位置，后续讲")]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("然后3个bit位是"),t("strong",[o._v("record_type")]),o._v(",代表的是这行数据的数据类型，0-普通类型 1-B+树非叶子节点 2-最小值数据 3-最大值是数据")]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("最后16个bit位是"),t("strong",[o._v("next_record")]),o._v("，是指向下一条数据的指针")]),o._v(" "),t("hr"),o._v(" "),t("h2",{attrs:{id:"数据在磁盘上是如何存储的"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据在磁盘上是如何存储的"}},[o._v("#")]),o._v(" 数据在磁盘上是如何存储的")]),o._v(" "),t("p",[o._v("我们的数据是jack NULL m NULL xx_school，它实际存储格式如下："),t("br"),o._v("\n0x09 0x04 00000101 0000000000000000000000010000000000011001 jack NULL m NULL xx_school"),t("br"),o._v("\n但是实际上不是怎么存储的，"),t("strong",[o._v("需要根据数据库指定的字符集编码，进行编码后再存储的")]),o._v("，所以实际数据如下："),t("br"),o._v("\n0x09 0x04 00000101 0000000000000000000000010000000000011001 616161 636320 6262626262"),t("br"),o._v(" "),t("strong",[o._v("其实这还不是最终的存储格式，真实数据里还有一些隐藏字段")])]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("首先有一个"),t("strong",[o._v("DB_ROW_ID")]),o._v("字段，它是一个行的唯一标识，是数据库给你搞的一个唯一标识，不是你的主键ID字段。如果我们没有指定主键和unique key唯一索引的时候，它就内存自动加一个ROW_ID作为主键。")]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("接着是"),t("strong",[o._v("DB_TRX_ID")]),o._v("字段，这是跟事务相关的，它是说这是哪个事务更新的数据，是事务的ID。")]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("最后是"),t("strong",[o._v("DB_ROLL_PTR")]),o._v("字段，这是回滚指针，是用来进行事务回滚的。")]),o._v(" "),t("hr"),o._v(" "),t("p",[o._v("加上隐藏字段后，实际数据看起来可能如下："),t("br"),o._v("\n0x09 0x04 00000101 0000000000000000000000010000000000011001 00000000094c(DB_ROW_ID) 00000000032D(DB_TRX_ID) EA000010078E(DB_ROLL_PTR) 616161 636320 6262626262")]),o._v(" "),t("h2",{attrs:{id:"行溢出"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#行溢出"}},[o._v("#")]),o._v(" 行溢出")]),o._v(" "),t("p",[o._v("实际上我们的每行数据都是放在数据页中的，一个数据页默认大小是16kb，万一一行数据大小超过了16kb怎么办？"),t("br"),o._v("\n比如一个表的字段大小是VARCHAR（65535），就是说最大可以包含65535个字符，也就是65535个字节，这就远远大于16kb的大小了。"),t("br"),o._v(" "),t("img",{attrs:{src:A(355),alt:"大字段存储"}}),t("br"),o._v(" "),t("strong",[o._v("行溢出")]),o._v("：就是说一行数据存储的内容太多了，一个数据页都放不下了，此时只能溢出这个数据页，把数据溢出存放到其他数据页里，那些数据页就叫溢出页。"),t("br"),o._v(" "),t("strong",[o._v("当我们在数据库里插入一条数据的时候，实际是在内存里插入一个有复杂存储结构的一行数据，然后随着一些条件的发生，这行数据会被刷入到磁盘中去。")])]),o._v(" "),t("h2",{attrs:{id:"mysql数据页结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql数据页结构"}},[o._v("#")]),o._v(" mysql数据页结构")]),o._v(" "),t("p",[t("img",{attrs:{src:A(356),alt:"数据页结构",title:"mysql数据页结构图"}}),o._v("\n其中"),t("strong",[o._v("文件头")]),o._v("占了38个字节，"),t("strong",[o._v("数据页头")]),o._v("占了56个字节，"),t("strong",[o._v("最大记录和最小记录")]),o._v("占了26个字节，"),t("strong",[o._v("数据行")]),o._v("区域的大小是不固定的，"),t("strong",[o._v("空闲区域")]),o._v("的大小也是不固定的，"),t("strong",[o._v("数据页目录")]),o._v("的大小也是不固定的，然后"),t("strong",[o._v("文件尾部")]),o._v("占了8个字节。"),t("br"),o._v(" "),t("strong",[o._v("存放了多条数据后的数据页结构图如下：")]),t("br"),o._v("\n如果数据页里面"),t("strong",[o._v("存满了数据，那么空闲区域就没了")]),t("br"),o._v(" "),t("img",{attrs:{src:A(357),alt:"数据页满了的数据页结构",title:"mysql数据页结构图"}})]),o._v(" "),t("h2",{attrs:{id:"表空间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#表空间"}},[o._v("#")]),o._v(" 表空间")]),o._v(" "),t("p",[t("strong",[o._v("表空间")]),o._v(":其实我们创建的那些表都有一个表空间的概念，在磁盘上都会对应着“表名.ibd”这样的一个磁盘文件。"),t("br"),o._v(" "),t("em",[t("strong",[o._v("所以在物理层面，表空间就是对应一些磁盘上的数据文件。表空间对应的文件中是有很多数据页的。")])]),t("br"),o._v("\n一个表空间包含的数据页实在是太多了，不便于管理，所以在表空间中又引入了"),t("strong",[o._v("数据区")]),o._v("的概念，英文是"),t("strong",[o._v("extend")]),t("br"),o._v("\n一个数据区对应着连续的64个数据页，一个数据页是16kb，所以一个数据区是1MB，然后256个数据区就被划分为一组。"),t("br"),o._v(" "),t("strong",[o._v("对于表空间而言，它的第一组数据区的的第一个数据区的前3个数据页，都是固定，里面存放了一些描述性的数据。3个数据页存放信息如下：")]),t("br"),o._v(" "),t("strong",[o._v("FSP_HDR")]),o._v("这个数据页，它里面存放了表空间和这一组数据区的一些属性。"),t("br"),o._v(" "),t("strong",[o._v("IBUF_BITMAP")]),o._v("这个数据页，里面存放的是这一组数据页的所有"),t("strong",[o._v("insert buffer")]),o._v("信息。"),t("br"),o._v(" "),t("strong",[o._v("INODE")]),o._v("数据页，里面存放了一些特殊的信息"),t("br"),o._v(" "),t("strong",[o._v("表空间的其他组数据区的第一个数据区的头两个数据页，也是存放特殊信息的。")])]),o._v(" "),t("h2",{attrs:{id:"表空间的存储结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#表空间的存储结构"}},[o._v("#")]),o._v(" 表空间的存储结构")]),o._v(" "),t("p",[t("img",{attrs:{src:A(358),alt:"表空间的结构",title:"牢记表空间结构"}})]),o._v(" "),t("h2",{attrs:{id:"插入一条数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插入一条数据"}},[o._v("#")]),o._v(" 插入一条数据")]),o._v(" "),t("p",[o._v("假设此时我们要插入一条数据，那么是选择磁盘文件里的哪个数据页加载到缓存页里去呢？"),t("br"),o._v("\n因为我们知道要往哪个表里插入数据，所以可以得到表空间。找到表空间就可以找到对应的磁盘文件了（磁盘文件名为：表名.ibd）。有了磁盘文件后，可以从里面找一个extend组，找到一个extend，然后从里面找到一个数据页出来，这个数据页可能是空的，也可能已经有了一些数据了，然后就可以把这个数据页从磁盘里完整加载出来，放入Buffer Pool的缓存里。")]),o._v(" "),t("h2",{attrs:{id:"磁盘随机读写和数据库日志顺序读写"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#磁盘随机读写和数据库日志顺序读写"}},[o._v("#")]),o._v(" 磁盘随机读写和数据库日志顺序读写")]),o._v(" "),t("p",[o._v("磁盘结构及工作原理："),t("br"),o._v(" "),t("a",{attrs:{href:"https://blog.csdn.net/rodbate/article/details/50371855",target:"_blank",rel:"noopener noreferrer"}},[o._v("磁盘工作原理文章"),t("OutboundLink")],1)]),o._v(" "),t("p",[o._v("因为你要读取的这个数据页可能在磁盘的任意一个位置，所以你在读取磁盘里的数据页的时候只能是用"),t("strong",[o._v("随机读")]),o._v("的这种方式。")]),o._v(" "),t("p",[o._v("磁盘随机读的性能是比较差的，所以不可能每次更新数据都进行磁盘随机读，必须是读取一个数据页之后放到Buffer Pool的缓存里去，下次要更新的时候直接更新Buffer Pool里的缓存页。")]),o._v(" "),t("p",[o._v("对于磁盘随机读来说，主要关注的性能指标是IOPS和响应延迟"),t("br"),o._v("\n所谓"),t("strong",[o._v("顺序写")]),o._v("，就是说在一个磁盘日志文件里，一直在末尾追加日志")]),o._v(" "),t("p",[o._v("磁盘顺序写的性能其实是很高的，某种程度上来说，几乎可以跟内存随机读写的性能差不多，尤其是在数据库里其实也用了os cache机制，就是redo log顺序写入磁盘之前，先是进入os cache，就是操作系统管理的内存缓存里")]),o._v(" "),t("p",[o._v("所以对于这个写磁盘日志文件而言，最核心关注的是磁盘每秒读写多少数据量的吞吐量指标，就是说每秒可以写入磁盘100MB数据和每秒可以写入磁盘200MB数据，对数据库的并发能力影响也是极大的。")]),o._v(" "),t("p",[o._v("因为数据库的每一次更新SQL语句，都必然涉及到多个磁盘随机读取数据页的操作，也会涉及到一条redo log日志文件顺序写的操作。所以磁盘读写的IOPS指标，就是每秒可以执行多少个随机读写操作，以及每秒可以读写磁盘的数据量的吞吐量指标，就是每秒可以写入多少redo log日志，整体决定了数据库的并发能力和性能。")]),o._v(" "),t("p",[o._v("包括你磁盘日志文件的顺序读写的响应延迟，也决定了数据库的性能，因为你写redo log日志文件越快，那么你的SQL语句性能就越高。")]),o._v(" "),t("h2",{attrs:{id:"linux存储系统架构图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux存储系统架构图"}},[o._v("#")]),o._v(" linux存储系统架构图**")]),o._v(" "),t("p",[o._v("linux存储系统分为VFS层、文件系统层、Page Cache缓存层、通用Block层、IO调度层、Block设备驱动层、Block设备层")]),o._v(" "),t("p",[t("img",{attrs:{src:A(359),alt:"Linux存储系统架构图",title:"linux架构图"}})]),o._v(" "),t("p",[t("strong",[o._v("VFS层的作用")]),o._v("：\n根据你对哪个目录中的文件执行的磁盘IO操作，把IO操作交给具体的文件系统。")]),o._v(" "),t("p",[o._v("当MySQL发起一次数据页的随机读写，或者是一次redo log日志文件的顺序读写的时候，实际上会把磁盘IO请求交给linux系统的"),t("strong",[o._v("VFS层")]),o._v("处理。")]),o._v(" "),t("p",[o._v("举个例子，在linux系统中，有的目录比如/xx1/xx2里的文件其实是由NFS文件系统管理的，有的目录比如/xx3/xx4里的文件其实是由Ext3文件系统管理的，那么这个时候VFS层会根据你对哪个目录下的文件发起的IO操作，把请求交给对应的文件系统。")]),o._v(" "),t("p",[o._v("接着文件系统会在"),t("strong",[o._v("Page Cache缓存")]),o._v("中查找你要找的数据在不在里面，如果存在，就基于内存缓存进行读写，如果没有就继续往下一层走，此时这个请求就会交给"),t("strong",[o._v("通用Block层")]),o._v("，在这一层会把你对文件的IO请求转换成Block IO请求。")]),o._v(" "),t("p",[o._v("接着会把这个Block IO请求交给"),t("strong",[o._v("IO调度层")]),o._v("，在这一层默认是采用CFQ公平调度算法的。")]),o._v(" "),t("p",[t("strong",[o._v("CFQ公平调度算法")]),o._v("，指的是假设你对数据库发起的多个sql语句同时在执行IO操作。有一个sql非常简单，update xx set xx1=xx2 where id =1;但是另一条sql语句是：select * from xx where xx1 like '%xx%',可能需要读取磁盘上大量的数据。此时基于公平调度算法，可能会导致先执行第二个sql语句，这个操作耗时很久，然后第一个sql语句一直得不到执行的机会。")]),o._v(" "),t("p",[t("strong",[o._v("扩展知识")]),o._v("：\nNFS（Network File System）即网络文件系统，是FreeBSD支持的文件系统中的一种，它允许网络中的计算机之间通过TCP/IP网络共享资源。在NFS的应用中，本地NFS的客户端应用可以透明地读写位于远端NFS服务器上的文件，就像访问本地文件一样。"),t("br"),o._v("\n它的用途：网络上与他人共享目录和文件。")]),o._v(" "),t("h3",{attrs:{id:"mysql生产调优经验"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql生产调优经验"}},[o._v("#")]),o._v(" "),t("font",{attrs:{color:"#FF0000",size:"4"}},[o._v("mysql生产调优经验")])],1),o._v(" "),t("p",[o._v("所以这里，"),t("font",{attrs:{color:"#0000FF",size:"4"}},[o._v("建议mysql生产中，需要调整为deadline IO调度算法")]),o._v("。他的核心思想是任何一个IO操作都不能一直等待，在指定的时间范围内，都必须让它执行。")],1),o._v(" "),t("p",[o._v("IO调度完成之后，会决定哪个IO请求先执行，哪个IO请求后执行。此时可以执行的IO请求就会交给"),t("strong",[o._v("Block设备驱动层")]),o._v("，然后经过驱动把IO请求发送给真正的存储硬件，也就是"),t("strong",[o._v("Block设备层")]),t("br"),o._v("\n然后硬件设备完成了IO读写操作之后，会把响应结果按照上图反向依次返回，最终MySQL可以得到本次IO读写操作的结果。")]),o._v(" "),t("h2",{attrs:{id:"数据库服务器的raid存储架构初步介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库服务器的raid存储架构初步介绍"}},[o._v("#")]),o._v(" 数据库服务器的RAID存储架构初步介绍")]),o._v(" "),t("p",[o._v("mysql、linux和硬件（cpu、内存、磁盘、网卡）的关系\n"),t("img",{attrs:{src:A(360),alt:"mysql linux 硬件",title:"mysql和操作系统的关系"}})]),o._v(" "),t("p",[o._v("一般来说，很多数据库部署在机器上的时候，存储都是搭建的RAID存储架构。"),t("strong",[o._v("RAID就是一个磁盘冗余阵列")])]),o._v(" "),t("p",[o._v("假设我们的服务器里的磁盘就一块，那万一 一块磁盘的容量不够怎么办？此时是不是就可以再搞几块磁盘出来放在服务器里")]),o._v(" "),t("p",[o._v("现在多搞了几块磁盘，机器里有很多块磁盘了，不好管理啊，怎么在多块磁盘上存放数据呢？")]),o._v(" "),t("p",[o._v("所以就是针对这个问题，在存储层面往往会在机器里搞多块磁盘，然后引入"),t("strong",[o._v("RAID这个技术，大致理解为用来管理机器里的多块磁盘的一种磁盘阵列技术！")]),o._v(" "),t("font",{attrs:{color:"#0000FF",size:"4"}},[o._v("有了RAID以后，你在往磁盘里读写数据的时候，他会告诉你应该在哪块磁盘上读写数据")]),o._v("\n当我们往磁盘里写数据的时候，通过RAID技术可以帮助我们选择一块磁盘写入，在读取数据的时候，我们也知道从哪块磁盘去读取。\n"),t("img",{attrs:{src:A(361),alt:"RAID架构"}})],1),o._v(" "),t("p",[o._v("RAID技术另一个很重要的一个作用，就是他还可以"),t("strong",[o._v("实现数据冗余机制")])]),o._v(" "),t("p",[o._v("所以其实有的RAID磁盘冗余阵列技术里，是可以把你写入的同样一份数据，在两块磁盘上都写入的，这样可以让两块磁盘上的数据一样，作为冗余备份，然后当你一块磁盘坏掉的时候，可以从另外一块磁盘读取冗余数据出来，这一切都是RAID技术自动帮你管理的，不需要你操心，如下图。\n"),t("img",{attrs:{src:A(362),alt:"RAID架构"}})]),o._v(" "),t("h2",{attrs:{id:"数据库服务器上的raid存储架构的电池充放电原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库服务器上的raid存储架构的电池充放电原理"}},[o._v("#")]),o._v(" 数据库服务器上的RAID存储架构的电池充放电原理")]),o._v(" "),t("p",[o._v("服务器使用多块磁盘组成的RAID阵列的时候，一般会有一个RAID卡，这个RAID卡是带有一个缓存的，这个缓存不是我们服务器的主内存那种，而是跟内存类似的SDRAM，其实类似于内存。")]),o._v(" "),t("p",[o._v("然后我们可以把RAID的缓存模式设置为write back，这样的话，所有写入到磁盘阵列的数据，会先缓存在RAID卡的缓存里，后续会慢慢写入到磁盘阵列中去，这种写缓冲机制，可以大幅度提升我们数据库磁盘写的性能。\nRAID架构-SDRAM缓存架构图：\n"),t("img",{attrs:{src:A(363),alt:"RAID架构-SDRAM缓存",title:"SDRAM缓存"}})]),o._v(" "),t("p",[t("strong",[o._v("假如突然断电了，RAID卡的缓存里的数据会不会突然丢失？")]),o._v("\n为了解决这个问题，RAID卡一般都配有自己独立的锂电池或者是电容，如果遇到断电，会由自己的锂电池来供电运行，然后它会赶紧把输入写入到阵列中的磁盘上去。\nRAID架构-SDRAM缓存（锂电池）\n"),t("img",{attrs:{src:A(364),alt:"SDRAM缓存和锂电池",title:"SDRAM缓存和锂电池"}}),o._v("\n但是锂电池是存在性能衰减问题的，所以一般来说锂电池都是要配置定时充放电的，也就是说每隔30~90天（锂电池厂商来定），就会自动对锂电池充放电一次，这样可以延长锂电池的寿命和校准电池容量。")]),o._v(" "),t("p",[o._v("在锂电池充放电的过程中，RAID的缓存级别会从write back变成write throuth，我们通过RAID写数据的时候，IO就直接写磁盘了，如果写内存是0.1ms这个级别，那么写磁盘就会退化10倍，到毫秒级别了。")]),o._v(" "),t("p",[t("strong",[o._v("所以一旦RAID自动充放电，往往会导致你的数据库服务器的RAID存储定期的性能出现几十倍的抖动，间接导致你的数据库性能每隔一段时间就会出现几十倍的抖动")])]),o._v(" "),t("h2",{attrs:{id:"raid锂电池充放电导致的mysql数据库性能抖动的优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#raid锂电池充放电导致的mysql数据库性能抖动的优化"}},[o._v("#")]),o._v(" RAID锂电池充放电导致的MySQL数据库性能抖动的优化")]),o._v(" "),t("p",[t("strong",[o._v("RAID 0")]),o._v("指的是所有的数据都是分散写入不同的磁盘，因为有多快磁盘，所以你的磁盘阵列的整体容量就很大，而且同时写入多块磁盘，让你的磁盘读写并发能力很强。\n"),t("strong",[o._v("RAID 0的缺点")]),o._v("：但是这种模式下，最大的问题就是万一你磁盘坏了一块，那么就会丢失一部分数据了。一般如果你要严格保证磁盘数据不丢失的话，就得用RAID 1。")]),o._v(" "),t("p",[t("strong",[o._v("RAID 1")]),o._v("指的是两块磁盘为镜像关系，你写的所有数据，在两块磁盘上都有，形成了数据冗余，一块磁盘坏了，另外一块磁盘上还有数据。")]),o._v(" "),t("p",[t("strong",[o._v("RAID 10")]),o._v("，就是RAID 0 + RAID 1组合起来，就是说当时生产环境的服务器部署，我们有6块磁盘组成了一个RAID 10的阵列，那么其实就是每2块磁盘组成一个RAID 1互为镜像的架构，存放的数据是冗余一样的，一共有3组RAID 1，然后对于每一组RAID 1写入数据的时候，是用RAID 0的思路，就是不同组的磁盘的数据是不一样的，但是同一组内的两块磁盘的数据是冗余一致的，如下图。")]),o._v(" "),t("p",[o._v("RAID10架构图：\n"),t("img",{attrs:{src:A(365),alt:"RAID10技术",title:"RAID10技术"}})]),o._v(" "),t("p",[o._v("所以对于这样的一个使用了RAID 10架构的服务器，他必然内部是有一个锂电池的，然后这个锂电池的厂商设定的默认是30天进行一次充放电，每次锂电池充放电就会导致RAID写入时不经过缓存，性能会急剧下降，所以我们发现线上数据库每隔30天就会有一次剧烈性能抖动，数据库性能下降了10倍。")]),o._v(" "),t("h2",{attrs:{id:"生产优化-锂电池充放电导致性能抖动的三种解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生产优化-锂电池充放电导致性能抖动的三种解决方案"}},[o._v("#")]),o._v(" 生产优化：锂电池充放电导致性能抖动的三种解决方案：")]),o._v(" "),t("p",[o._v("给RAID卡把锂电池换成电容，电容是不用频繁充放电的，不会导致充放电的性能抖动，还有就是电容可以支持透明充放电，就是自动检查电量，自动进行充电，不会说在充放电的时候让写IO直接走磁盘，但是更换电容很麻烦，而且电容比较容易老化，这个其实一般不常用")]),o._v(" "),t("p",[t("strong",[o._v("手动充放电，这个比较常用")]),o._v("，包括一些大家知道的顶尖互联网大厂的数据库服务器的RAID就是用了这个方案避免性能抖动，"),t("strong",[o._v("就是关闭RAID自动充放电，然后写一个脚本，脚本每隔一段时间自动在晚上凌晨的业务低峰时期，脚本手动触发充放电")]),o._v("，这样可以避免业务高峰期的时候RAID自动充放电引起性能抖动")]),o._v(" "),t("p",[o._v("充放电的时候不要关闭write back，就是设置一下，锂电池充放电的时候不要把缓存级别从write back修改为write through，这个也是可以做到的，可以和第二个策略配合起来使用")]),o._v(" "),t("h2",{attrs:{id:"生产实战-数据库无法连接故障的定位-too-many-connections"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生产实战-数据库无法连接故障的定位-too-many-connections"}},[o._v("#")]),o._v(" 生产实战：数据库无法连接故障的定位，Too many connections**")]),o._v(" "),t("p",[o._v("异常信息是：ERROR 1040(HY000):Too many connections."),t("br"),o._v("\n含义是说数据库连接池里已经有太多的连接了，不能在跟你建立新的连接了。"),t("br"),o._v("\n我们的数据库部署在64GB的大物理机上，配置很高。然后java系统有两个，分别部署在两个机器上，java系统设置连接池的最大大小是200，那两个机器就是最大400个连接。\n"),t("img",{attrs:{src:A(366),alt:"java连接数据库"}}),o._v("\n但是这个时候mysql报异常说：too many connections，难道mysql400个连接都没有？接着去检查mysql的配置文件，my.cnf,里面有个关键参数max_connections,就是mysql设置的最大连接数，是800.\n为什么mysql最大连接数是800，两台机器要建立400个连接都不行呢？\n用命令行或者一些管理工具登录到mysql上去，执行下面的命令看看："),t("br"),o._v(" "),t("strong",[o._v("show variables like 'max_connections'")]),t("br"),o._v("\n此时你可以看到，mysql仅仅建立了214个连接。"),t("br"),o._v("\n这时可以猜想，mysql启动时，根本没管我们设置的那个max_connections，就直接强行把最大连接数设置为214了？于是去检查了一下mysql的启动日志，可以看到如下字样：\n"),t("img",{attrs:{src:A(367),alt:"mysql启动日志",title:"mysql启动日志，最大连接数"}}),o._v(" "),t("strong",[o._v("原因")]),o._v("："),t("font",{attrs:{color:"FF0000",size:"4"}},[o._v("底层的linux把进程可以打开的文件句柄数限制为了1024了，导致mysql的最大连接数是214了。")]),o._v(" "),t("img",{attrs:{src:A(368),alt:"mysql最大连接数",title:"mysql最大连接数限制原因"}})],1),o._v(" "),t("h2",{attrs:{id:"生产实战-如何解决经典的too-many-connections故障"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生产实战-如何解决经典的too-many-connections故障"}},[o._v("#")]),o._v(" 生产实战：如何解决经典的Too many connections故障？")]),o._v(" "),t("p",[o._v("解决方案：就是下面的一行命令"),t("br"),o._v(" "),t("font",{attrs:{color:"FF0000",size:"4"}},[o._v("ulimit -HSn 65535")]),t("br"),o._v("\n然后使用如下的命令检查最大文件句柄数是否被修改了："),t("br"),o._v("\ncat /etc/security/limits.conf"),t("br"),o._v("\ncat /etc/rc.local"),t("br"),o._v("\n最后重启mysql即可，里面配置的最大连接数就会生效了。")],1),o._v(" "),t("p",[o._v("另外再给大家解释一个问题，有人还是疑惑说，为什么linux的最大文件句柄限制为1024的时候，MySQL的最大连接数是214呢？")]),o._v(" "),t("p",[o._v("这个其实是MySQL源码内部写死的，他在源码中就是有一个计算公式，算下来就是如此罢了！")]),o._v(" "),t("p",[o._v("然后再给大家说一下，这个linux的ulimit命令是干嘛用的，其实说白了，linux的话是默认会限制你每个进程对机器资源的使用的，包括可以打开的文件句柄的限制，可以打开的子进程数的限制，网络缓存的限制，最大可以锁定的内存大小。")]),o._v(" "),t("p",[o._v("因为linux操作系统设计的初衷，就是要尽量避免你某个进程一下子耗尽机器上的所有资源，所以他默认都是会做限制的。")]),o._v(" "),t("p",[o._v("所以说，往往你在生产环境部署了一个系统，比如数据库系统、消息中间件系统、存储系统、缓存系统之后，都需要调整一下"),t("strong",[o._v("linux的一些内核参数，这个文件句柄的数量是一定要调整的，通常都得设置为65535")])]),o._v(" "),t("p",[t("font",{attrs:{color:"FF0000",size:"4"}},[o._v("可以用ulimit命令来设置每个进程被限制使用的资源量，用ulimit -a就可以看到进程被限制使用的各种资源的量")])],1),o._v(" "),t("p",[o._v("比如 core file size 代表的进程崩溃时候的转储文件的大小限制，max locked memory就是最大锁定内存大小，open files就是最大可以打开的文件句柄数量，max user processes就是最多可以拥有的子进程数量。")]),o._v(" "),t("p",[o._v("设置之后，我们要确保变更落地到/etc/security/limits.conf文件里，永久性的设置进程的资源限制")]),o._v(" "),t("p",[o._v("所以执行ulimit -HSn 65535命令后，要用如下命令检查一下是否落地到配置文件里去了。")]),o._v(" "),t("p",[o._v("cat /etc/security/limits.conf"),t("br"),o._v("\ncat /etc/rc.local")]),o._v(" "),t("h2",{attrs:{id:"redo日志对于事务提交后-数据绝对不会丢失的意义"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redo日志对于事务提交后-数据绝对不会丢失的意义"}},[o._v("#")]),o._v(" redo日志对于事务提交后，数据绝对不会丢失的意义")]),o._v(" "),t("p",[t("strong",[o._v("redo log的本质")]),o._v("是保证事务提交之后，修改的数据绝对不会丢失。"),t("br"),o._v(" "),t("img",{attrs:{src:A(369),alt:"数据页->缓存页"}})]),o._v(" "),t("p",[o._v("其实你更新缓存页的时候，会更新free链表、flush链表、lru链表，然后有专门的后台IO线程，不定时的根据flush链表、lru链表，把你更新的数据刷新到磁盘文件中去。")]),o._v(" "),t("p",[t("font",{attrs:{color:"FF0000",size:"5"}},[o._v("事务提交时把修改过的缓存页都刷入磁盘和你事务提交时把你做的修改的redo log写入日志文件的区别在哪里，他们不都是写入磁盘吗？")]),o._v("\n实际上如果把你修改过的缓存页都刷入磁盘，"),t("strong",[o._v("一个缓存页大小是16kb，数据比较大，刷入磁盘比较耗时")]),o._v("，而且可能只修改了缓存页的几个字节的数据，你要把整个缓存页都刷入磁盘吗？"),t("br"),o._v(" "),t("strong",[o._v("刷入磁盘是随机写入磁盘，性能很差的")]),o._v("，因为一个缓存页对应的位置可能在磁盘文件的一个随机位置，比如偏移量为45336这个地方。"),t("br"),o._v(" "),t("strong",[o._v("如果是写redo log日志")]),o._v("，"),t("br"),o._v(" "),t("strong",[o._v("第一点")]),o._v("：redo log可能就占几十个字节，就包含表空间号、数据页号、磁盘文件偏移量、更新值，这个写入磁盘速度很快。"),t("br"),o._v(" "),t("strong",[o._v("第二点")]),o._v("：redo log写日志，是顺序写入磁盘文件，每次都是追加到磁盘文件末尾去，速度也是很快的。"),t("br"),o._v(" "),t("font",{attrs:{color:"FF0000",size:"4"}},[o._v("总结：所以你提交事务的时候，用redo log形式记录下来你所做的修改，性能远远超过刷新缓存页的方式，可以使你的数据库并发能力更强")])],1),o._v(" "),t("h2",{attrs:{id:"redo-log日志结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redo-log日志结构"}},[o._v("#")]),o._v(" redo log日志结构")]),o._v(" "),t("p",[o._v("redo log本质上是记录了对某个表空间的某个数据页的某个偏移量的地方修改了几个字节的值，具体修改的值是什么。"),t("br"),o._v("\n他里面需要记录的就是"),t("strong",[o._v("表空间号+数据页号+偏移量+修改几个字节的值+具体的值")])]),o._v(" "),t("p",[o._v("所以根据你修改了数据页里的几个字节的值，redo log就划分为了不同的类型，MLOG_1BYTE类型的日志指的就是修改了1个字节的值，MLOG_2BYTE类型的日志指的就是修改了2个字节的值，以此类推，，还有修改了4个字节的值的日志类型，修改了8个字节的值的日志类型。")]),o._v(" "),t("p",[o._v("如果你要是一下子修改了一大串的值，类型就是MLOG_WRITE_STRING，就是代表你一下子在那个数据页的某个偏移量的位置插入或者修改了一大串的值。")]),o._v(" "),t("p",[t("strong",[o._v("redo log日志大致的结构如下所示")]),o._v("："),t("br"),o._v("\n日志类型（MLOG_1BYTE等），表空间ID，数据页号，数据页中的偏移量，具体修改的数据")]),o._v(" "),t("hr"),o._v(" "),t("p",[t("strong",[o._v("日志类型就告诉了你他这次增删改操作修改了多少字节的数据")]),o._v("，有了上述信息，就可以精准完美的还原出来一次数据增删改操作做的变动了。")]),o._v(" "),t("p",[o._v("只不过如果是MLOG_WRITE_STRING类型的日志，因为不知道具体修改了多少字节的数据，所以其实会多一个修改数据长度，就告诉你他这次修改了多少字节的数据，如下所示他的格式：")]),o._v(" "),t("p",[t("strong",[o._v("日志类型（MLOG_WRITE_STRING）")]),o._v("，表空间ID，数据页号，数据页中的偏移量，"),t("strong",[o._v("修改数据长度")]),o._v("，具体修改的数据")]),o._v(" "),t("h2",{attrs:{id:"redo-log是一条一条写入日志文件的吗-非也"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redo-log是一条一条写入日志文件的吗-非也"}},[o._v("#")]),o._v(" redo log是一条一条写入日志文件的吗，非也")]),o._v(" "),t("p",[o._v("其实在mysql内部有另一个数据结构，叫做"),t("strong",[o._v("redo log block")]),o._v("，它可以存放多个单行日志。"),t("br"),o._v(" "),t("strong",[o._v("redo log block结构图：")]),t("br"),o._v("\n一个redo log block是512个字节，总共分为3部分："),t("br"),o._v("\n第一部分：12个字节的header（块头）"),t("br"),o._v("\n块头分为四部分："),t("br"),o._v("\n1, 4个字节的block_no，就是块唯一编号\n2，2个字节的data length，就是block里写入了多少字节的数据\n3，2个字节的first record group，这个是说每个事务会有多个redo log，是一个redo log group，即一组redo log。那么在这个block里的第一组    redo log的偏移量，就是这2个字节存储的。"),t("br"),o._v("\n4，4个字节的checkpoint on"),t("br"),o._v("\n第二部分：496个字节的body（块体）"),t("br"),o._v("\n第三部分：4个字节的trailer（块尾）"),t("br"),o._v(" "),t("img",{attrs:{src:A(370),alt:"redo log block结构图",title:"redo log block结构图"}})]),o._v(" "),t("p",[o._v("细化header的redo log block结构图："),t("br"),o._v(" "),t("img",{attrs:{src:A(371),alt:"有header的redo log block结构图",title:"有header的redo log block结构图"}})]),o._v(" "),t("p",[o._v("假设你要写第一个redo log了，是不是首先要在内存里把这个redo log给弄到一个redo log block数据结构中去？"),t("br"),o._v("\n然后等你的512个字节的redo log block的数据都满了，再一次性把这个redo log block给写入到磁盘文件中。那么此时redo log文件里就多了一个block。"),t("br"),o._v(" "),t("img",{attrs:{src:A(372),alt:"redo log日志文件中block结构"}}),t("br"),o._v(" "),t("img",{attrs:{src:A(373),alt:"redo log日志文件中block结构"}})]),o._v(" "),t("h2",{attrs:{id:"redo-log是直接写入磁盘文件吗"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redo-log是直接写入磁盘文件吗"}},[o._v("#")]),o._v(" redo log是直接写入磁盘文件吗？")]),o._v(" "),t("p",[o._v("不是的，需要用到一个组件redo log buffer。它就是MySQL专门设计的，用来缓冲redo log写入的。"),t("br"),o._v(" "),t("strong",[o._v("redo log buffer是MySQL在启动的时候，申请的一块连续的内存，里面划分出了N多个redo log block，如下图所示")]),o._v("："),t("br"),o._v(" "),t("img",{attrs:{src:A(374),alt:"redo log buffer结构",title:"redo log buffer结构"}}),o._v(" "),t("font",{attrs:{color:"FF0000",size:"4"}},[o._v("通过设置innodb_log_buffer_size可以指定redo log buffer的大小，默认值是16M，已经很大了，毕竟一个redo log block才512个字节 ")])],1),o._v(" "),t("p",[o._v("当我们要写一条redo log的时候，就会先从redo log block开始写入，写满一个redo log block，再接着写下一个，当所有的redo log block都写满了，那么此时必然会强制把redo log block刷入到磁盘中去。"),t("br"),o._v(" "),t("img",{attrs:{src:A(375),alt:"redo log buffer刷入磁盘",title:"redo log buffer结构"}}),t("br"),o._v("\n需要注意一点，我们平时执行一个事务的过程中，每个事务会有多个增删改查操作，那么就会有多个redo log，这些属于一个事务的redo log就是一组redo log。"),t("br"),o._v("\n其实每次这一组redo log都是在别的地方暂存，都执行完了，才会把这组redo log给写入到redo log buffer 的block中去。"),t("br"),o._v(" "),t("strong",[o._v("redo log太多一个block放不下的情形：")]),o._v(" "),t("img",{attrs:{src:A(376),alt:"redo log太多一个block放不下的情形",title:"redo log太多一个block放不下的情形"}}),t("br"),o._v(" "),t("strong",[o._v("redo log太小挤到一个block中的情形：")]),t("br"),o._v(" "),t("img",{attrs:{src:A(377),alt:"redo log太小挤到一个block中的情形",title:"redo log太小挤到一个block中的情形"}})]),o._v(" "),t("h2",{attrs:{id:"redo-log-buffer中的缓冲日志-到底什么时候可以写入磁盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redo-log-buffer中的缓冲日志-到底什么时候可以写入磁盘"}},[o._v("#")]),o._v(" redo log buffer中的缓冲日志，到底什么时候可以写入磁盘？")]),o._v(" "),t("p",[t("strong",[o._v("redo log block刷入到磁盘中的时机有如下几种：")]),t("br"),o._v("\n（1）如果写入redo log buffer中的日志已经占据了redo log buffer总容量的一半了，也就是超过了8M的redo log 在缓冲里，此时就会把他们刷入磁盘文件中去"),t("br"),o._v("\n（2）一个事务提交的时候，必须把它的那些redo log所在的redo log block都刷入到磁盘文件里去。因为只有这样，当事务提交的时候，他修改的数据绝对不会丢失，因为redo log里面有重做日志，随时可以恢复事务做的修改。"),t("br"),o._v(" "),t("img",{attrs:{src:A(378),alt:"redo log-os cache"}}),o._v("\n（3）后台线程定时刷新，有一个后台线程每隔1s就会把redo log buffer里的redo log block刷到磁盘文件里去"),t("br"),o._v("\n（4）MySQL关闭的时候，redo log block都会刷入到磁盘文件中去。"),t("br"),o._v(" "),t("strong",[o._v("总结：不管怎么说，都是为了保证一个事务执行的时候，redo log都进入redo log buffer，事务提交的时候，事务对应的redo log必须刷入磁盘文件，接着才算是事务提交成功，否则事务提交就是失败。保证这一点，就是保证了事务提交之后，数据不会丢失，有redo log在磁盘文件里就行了。")]),t("br"),o._v("\n还得配置一个参数，提交事务把redo log刷入磁盘文件的os cache后，还得强行从os cache刷入物理磁盘。")]),o._v(" "),t("p",[t("font",{attrs:{color:"FF0000",size:"4"}},[o._v("是把所有的redo log日志文件都写入到同一个日志文件中吗？对磁盘占用空间越来越大怎么办？")]),t("br"),o._v("\n实际上默认情况下，redo log都会写入同一个目录的文件中，这个目录可以通过 "),t("font",{attrs:{color:"FF0000",size:"4"}},[o._v("show variables like 'datadir'")]),o._v(" 来查看,可以通过"),t("font",{attrs:{color:"FF0000",size:"4"}},[o._v("innodb_log_group_home_dir")]),o._v("参数来设置这个目录，然后redo log文件是有多个的，写满一个，会写下一个redo log文件，通过"),t("font",{attrs:{color:"FF0000",size:"4"}},[o._v("innodb_log_file_size")]),o._v("可以指定每个redo log文件的大小，默认是48M，通过"),t("font",{attrs:{color:"FF0000",size:"4"}},[o._v("innodb_log_files_in_group")]),o._v("指定日志文件的数量，默认就2个。")],1),o._v(" "),t("p",[o._v("所以默认情况下，目录里就两个日志文件，分别是ib_logfile0和ib_logfile1，每个48M，如果两个文件都写满了，那么会重新开始写第一个文件，覆盖原来的内容。所以MySQL最多会保留最近的96M的redo log。一个redo log几个字节到几十个字节不等，96M足够你存储上百万的redo log了。")]),o._v(" "),t("h2",{attrs:{id:"事务执行到一半要回滚怎么办-再探undo-log回滚日志原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#事务执行到一半要回滚怎么办-再探undo-log回滚日志原理"}},[o._v("#")]),o._v(" 事务执行到一半要回滚怎么办，再探undo log回滚日志原理！")]),o._v(" "),t("p",[o._v("undo log日志，也就是回滚日志，这种日志要应对的场景，就是事务回滚的场景。"),t("br"),o._v(" "),t("strong",[o._v("一个事务里的一通增删改执行到一半，需要回滚，怎么办？")]),t("br"),o._v(" "),t("img",{attrs:{src:A(379),alt:"redo log做到一半需要回滚示意图",title:"redo log做到一半需要回滚示意图"}})]),o._v(" "),t("p",[t("strong",[o._v("undo log日志记录的东西")]),o._v("其实非常简单，如果你在缓存页里执行了一个insert语句，那么此时你在undo log日志里需要记录这条记录的主键和一个delete语句，能让你把这次操作给回退了。")]),o._v(" "),t("p",[o._v("如果你在缓存页里执行的是delete语句，那么你要把删除的那条数据记录下来，如果要回滚，执行一个insert操作，把那条数据插入回去。")]),o._v(" "),t("p",[o._v("如果你在缓存页里执行的是update语句，那么你起码要把更新前的那个值记录下来，回滚的时候重新update一下，把你之前更新前的旧值给更新回去。"),t("br"),o._v(" "),t("img",{attrs:{src:A(380),alt:"undo log示意图",title:"undo log示意图"}})])])}),[],!1,null,null,null);r.default=v.exports}}]);